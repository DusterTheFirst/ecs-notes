<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Text Editor v2 contd. (October 19, 2020) - ECS Notes</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">Welcome</a></li><li class="spacer"></li><li class="chapter-item expanded "><div><strong aria-hidden="true">1.</strong> Scheme</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../scheme/2020-10-13.html"><strong aria-hidden="true">1.1.</strong> Unions and data design (October 13 2020)</a></li><li class="chapter-item expanded "><a href="../scheme/2020-10-14.html"><strong aria-hidden="true">1.2.</strong> Text Editor v2 (October 14, 2020)</a></li><li class="chapter-item expanded "><a href="../scheme/2020-10-19.html" class="active"><strong aria-hidden="true">1.3.</strong> Text Editor v2 contd. (October 19, 2020)</a></li><li class="chapter-item expanded "><a href="../scheme/2020-12-1.html"><strong aria-hidden="true">1.4.</strong> Recursion and balloon game (December 1, 2020)</a></li></ol></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.</strong> Python</div></li><li><ol class="section"><li class="chapter-item expanded "><a href="../python/introduction.html"><strong aria-hidden="true">2.1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../python/constants-functions.html"><strong aria-hidden="true">2.2.</strong> Constants and Functions</a></li><li class="chapter-item expanded "><a href="../python/lists.html"><strong aria-hidden="true">2.3.</strong> Lists</a></li><li class="chapter-item expanded "><div><strong aria-hidden="true">2.4.</strong> Conditionals and Returns</div></li><li class="chapter-item expanded "><a href="../python/loops.html"><strong aria-hidden="true">2.5.</strong> Loops</a></li><li class="chapter-item expanded "><a href="../python/input-random.html"><strong aria-hidden="true">2.6.</strong> User inputs and randomness</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../help-sheet.html">ECS Help Sheet</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">ECS Notes</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                        <a href="https://github.com/DusterTheFirst/ecs-notes" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#text-editor-v2-contd-october-19-2020" id="text-editor-v2-contd-october-19-2020">Text Editor v2 contd (October 19, 2020)</a></h1>
<p><a href="#too-long-didnt-read">Jump to TL;DR (summary)</a><br />
<a href="#file-1-ecs-notes-md">Jump to Table Of Contents</a></p>
<h2><a class="header" href="#starting-where-we-left-off-last-week" id="starting-where-we-left-off-last-week">Starting where we left off last week</a></h2>
<p>Below is the code we have written for the text editor last week:</p>
<pre><code class="language-scheme">; A TextEditor is a (make-te String Nat)
(define-struct te [text cursor])
; and represents a text editor
; - where text is the text you have typed
; - and cursor is the index of the cursor

(define TE-EMPTY (make-te &quot;&quot; 0))
(define TE1 (make-te &quot;hello&quot; 1))
(define TE2 (make-te &quot;ECS&quot; 0))

; insert-text : TextEditor KeyEvent -&gt; TextEditor
; Insert text the user typed at the cursor's location
(check-expect (insert-text TE1 &quot;a&quot;)l
              (make-te &quot;haello&quot; 2))
(check-expect (insert-text TE2 &quot;right&quot;)
              (make-te &quot;ECS&quot; 1))
</code></pre>
<p>We had created a simple structure for the text editor which can hold
both the text and the cursor position.</p>
<p>We have accidentally skipped a step between the <code>TextEditor</code> structure and the
<code>insert-text</code> function. We need to make a template.</p>
<h3><a class="header" href="#texteditor-template" id="texteditor-template">TextEditor template</a></h3>
<p>We are now going to design the template.
See <a href="#designing-templates">ECS Help Sheet's <code>Designing Templates</code> section</a>.</p>
<pre><code class="language-scheme">(define (te-template te)
    (... (te-text te)
         (te-cursor te)
         ...))
</code></pre>
<p>Since both of these are <code>primitives</code> or things that we have not defined ourselves,
we do not have to call or make any more templates, we can just use them directly.</p>
<h3><a class="header" href="#figuring-out-what-stays-the-same" id="figuring-out-what-stays-the-same">Figuring out what stays the same</a></h3>
<blockquote>
<p>See: <a href="#designing-programs">ECS Help Sheet's <code>Designing Programs</code> section</a> for more information on
designing a program</p>
</blockquote>
<p>Lets make some constants. We know that the background will stay the same, so lets make that</p>
<pre><code class="language-scheme">(define BACKGROUND (rectangle 600 200 &quot;solid&quot; &quot;light blue&quot;))
</code></pre>
<p>We also know that the font color, font size, and an image for the cursor will stay the same:</p>
<pre><code class="language-scheme">(define FONT-COLOR &quot;black&quot;)
(define FONT-SIZE 20)
(define CURSOR-IMAGE (rectangle 2 50 &quot;solid&quot; &quot;black&quot;))
</code></pre>
<blockquote>
<p>Remember, we can always come back and define more constants, these are just the ones we
can think of right now. And remember, putting things in constants will help a lot since you only
have to change them in one spot, and not all over your program if you want to change their value</p>
</blockquote>
<h3><a class="header" href="#figuring-out-what-clauses-we-need" id="figuring-out-what-clauses-we-need">Figuring out what clauses we need</a></h3>
<p>Now that we have some constants, we can move to step 2. We need to figure out what
clauses we need.
We will probably need <code>to-draw</code> so that we can draw the world, we want <code>on-mouse</code> so that we can
click and move the cursor around, and lastly we want <code>on-key</code> so we can capture the user's typing
and display it.</p>
<h3><a class="header" href="#our-main-function" id="our-main-function">Our main function</a></h3>
<p>Finally, we are here!!1! We can design our main function. Lets call this <code>microsoft-word</code>
(this might violate tons of trademark law, but we are too cool for trademark law). We also need to
figure out what goes in and what comes out. With most all main functions, they will take in the
<code>WorldState</code> and return a <code>WorldState</code>. And now, we can put it all together with a nice description
as well</p>
<pre><code class="language-scheme">; microsoft-word : TextEditor -&gt; TextEditor
; Starts up a text editor where you can move the cursor
(define (microsoft-word initial-editor)
    (big-bang initial-editor
              [to-draw draw-text-editor]
              [on-mouse curse-of-the-cursor] ; Remember, these can be named whatever we want, as
                                             ; long as we know what they mean
              [on-key insert-text]))
</code></pre>
<p>Now that we have the main function and a wishlist of all the functions we want, we can make their
function signatures so we know what we want later when we design them.</p>
<h4><a class="header" href="#function-signatures" id="function-signatures">Function signatures</a></h4>
<p>Lets define our <code>draw-text-editor</code> signature. Since it is the <code>to-draw</code> handler, it takes in the
<code>WorldState</code> and outputs the drawn <code>Image</code>. We can put it in a nice old comment with a description</p>
<pre><code class="language-scheme">; draw-text-editor : TextEditor -&gt; Image
; Draws the text with the cursor at a certain position
</code></pre>
<p>Now that we have <code>draw-text-editor</code>, we can define the <code>curse-of-the-cursor</code>. This function will be
in the clause <code>on-mouse</code>. Because of that, it gives us some special things. As always, it will give
us the <code>WorldState</code> and it will also give us the x and y coordinate of the mouse and a <code>MouseEvent</code>
defining what the mouse did, and it returns a new modified (or not) <code>WorldState</code>. We can plop that
into a handy comment for us.</p>
<pre><code class="language-scheme">; curse-of-the-cursor : TextEditor Number Number MouseEvent -&gt; TextEditor
; Change the position of the cursor when you click
</code></pre>
<p>And we had already created the <code>insert-text</code> function last week:</p>
<pre><code class="language-scheme">; insert-text : TextEditor KeyEvent -&gt; TextEditor
; Insert text the user typed at the cursor's location
</code></pre>
<h4><a class="header" href="#defining-functions" id="defining-functions">Defining functions</a></h4>
<p>Now that we have all of the signatures in our wish list, we can start writing the functions.</p>
<p>We can start with the <code>draw-text-editor</code> function. As always, we need to start with some check
expects.</p>
<pre><code class="language-scheme">(check-expect
    (draw-text-editor TE-EMPTY)
    (overlay (beside CURSOR_IMAGE (text &quot; &quot; FONT-SIZE FONT-COLOR)) ; This will create the blank
                                                                   ; image with just a cursor
    BACKGROUND))
(check-expect
    (draw-text-editor TE1)
    (overlay 
        (beside (text &quot;h&quot;  FONT-SIZE FONT-COLOR)
                CURSOR_IMAGE
                (text &quot;ello&quot; FONT-SIZE FONT-COLOR)) ; Here we put the cursor between the `h` and
                                                    ; `ello` since it is a cursor pos 1
    BACKGROUND))
</code></pre>
<p>Now we can go and define the <code>draw-text-editor</code> function body.
So, we want to have 2 states, either there is no text in the editor, or there is some text.
we can check for such using a <code>cond</code>.</p>
<pre><code class="language-scheme">(define (draw-text-editor editor)
    (cond [...]
          [...]))
</code></pre>
<p>Now we need to somehow get the text out of the editor structure. We can do so by using our template.
Lets paste it down here so we can use it.</p>
<pre><code class="language-scheme">(define (te-template te)
    (... (te-text te)
         (te-cursor te)
         ...))
</code></pre>
<p>To access the text, we can use the <code>te-text</code> helper function from our template.
So we can paste it into the first cond. We need to check it to make sure that its length is &gt; 0,
meaning it is not empty</p>
<pre><code class="language-scheme">(define (draw-text-editor editor)
    (cond [(&gt; (string-length (te-text editor)) 0)] ; new
          [...]))
</code></pre>
<p>Now we can define a simple template of what we will do. Remember, we want to write some text,
the cursor, and then the rest of the text</p>
<pre><code class="language-scheme">(define (draw-text-editor editor)
    (cond [(&gt; (string-length (te-text editor)) 0)
           (overlay (beside (text ... FONT-SIZE FONT-COLOR)    ; new
                            CURSOR-IMAGE                       ; new
                            (text ... FONT-SIZE FONT-COLOR))   ; new
                    BACKGROUND)]                               ; new
          [...]))
</code></pre>
<p>Now, we need to figure out how to draw the text in front of the cursor. We can get a slice of
a string by using the <code>substring</code> function, and use the cursor position to chop it. We want to get
the <code>substring</code> of the <code>te-text</code> from 0 up until <code>te-cursor</code></p>
<pre><code class="language-scheme">(define (draw-text-editor editor)
    (cond [(&gt; (string-length (te-text editor)) 0)
           (overlay (beside (text (substring (te-text editor) 0 ; new
                                             (te-cursor))       ; new
                                   FONT-SIZE FONT-COLOR)
                            CURSOR-IMAGE
                            (text ...))
                    BACKGROUND)]
          [...]))
</code></pre>
<p>And now that we have the first text, we can do the second text very much the same, except this time,
we don't need to give <code>substring</code> an ending point, because in doing so, <code>substring</code> will just go
until the end.</p>
<pre><code class="language-scheme">(define (draw-text-editor editor)
    (cond [(&gt; (string-length (te-text editor)) 0)
           (overlay (beside (text (substring (te-text editor) 0
                                             (te-cursor))
                                   FONT-SIZE FONT-COLOR)
                            CURSOR-IMAGE
                            (text (substring (te-text editor)   ; new
                                             (te-cursor))       ; new
                                  FONT-SIZE FONT-COLOR))
                    BACKGROUND)]
          [...]))
</code></pre>
<p>Now that we have the text having state, we can work on the section of the function when there
is no text to draw. Since we will draw the same thing every time you have no text, we can extract it
into a constant. We can copy it from our first check expect</p>
<pre><code class="language-scheme">(define BLANK-EDITOR-IMAGE
        (overlay (beside CURSOR_IMAGE (text &quot; &quot; FONT-SIZE FONT-COLOR)) ; This will create the blank
                                                                       ; image with just a cursor
        BACKGROUND))
</code></pre>
<p>and then update our check expect from</p>
<pre><code class="language-scheme">(check-expect
    (draw-text-editor TE-EMPTY)
    (overlay (beside CURSOR_IMAGE (text &quot; &quot; FONT-SIZE FONT-COLOR)) ; This will create the blank
                                                                   ; image with just a cursor
    BACKGROUND))
</code></pre>
<p>to</p>
<pre><code class="language-scheme">(check-expect
    (draw-text-editor TE-EMPTY)
    BLANK-EDITOR-IMAGE) ; changed
</code></pre>
<p>and we can add that into our new function</p>
<pre><code class="language-scheme">(define (draw-text-editor editor)
    (cond [(&gt; (string-length (te-text editor)) 0)
           (overlay (beside (text (substring (te-text editor) 0
                                             (te-cursor))
                                   FONT-SIZE FONT-COLOR)
                            CURSOR-IMAGE
                            (text (substring (te-text editor)
                                             (te-cursor))
                                  FONT-SIZE FONT-COLOR))
                    BACKGROUND)]
          [else BLANK-EDITOR-IMAGE])) ; new
</code></pre>
<h2><a class="header" href="#too-long-didnt-read" id="too-long-didnt-read">Too Long; Didn't Read</a></h2>
<ul>
<li>USE YOUR <a href="#file-2-ecs-help-sheet-md">ECS Help Sheet</a>.
It will walk you through it all.</li>
<li>Make constants! they will help you keep duplicated code to a minimum,
and will save you when you need to change them.</li>
<li>Complex programs can be broken down into simpler parts and are a lot easier
when you do so</li>
<li>WRITE COMMENTS. Since we were unable to finish the text editor today, we will thank
ourselves later when we have to come back to it, that we have left comments telling us about
what we still need to do. (Your memory can only serve you so well)</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../scheme/2020-10-14.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../scheme/2020-12-1.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../scheme/2020-10-14.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../scheme/2020-12-1.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        
        <!-- Google Analytics Tag -->
        <script type="text/javascript">
            var localAddrs = ["localhost", "127.0.0.1", ""];

            // make sure we don't activate google analytics if the developer is
            // inspecting the book locally...
            if (localAddrs.indexOf(document.location.hostname) === -1) {
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                ga('create', 'UA-107070534-2', 'auto');
                ga('send', 'pageview');
            }
        </script>
        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
